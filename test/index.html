<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Test IRISHub-RPC Server</title>
    <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css"
          integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <style type="text/css">
        div.title p {
            font-weight: bolder;
            font-size: larger;
            background-color: floralwhite;
            color: black;
        }
        div.title {
            margin-top: 3%;
            margin-bottom: 3%;
        }
        div.res {
            margin-top: 3%;
        }
        div.res p {
            font-weight: 700;
            color: green;
        }
    </style>
</head>
<body>

<div class="container-fluid">

    <ul class="nav nav-tabs" id="myTab" role="tablist">
        <li role="presentation" class="active"><a href="#getCandidateList" aria-controls="getCandidateList" role="tab"
                                                  data-toggle="tab">验证人列表</a>
        </li>
        <li role="presentation"><a href="#getCandidateDetail" aria-controls="getCandidateDetail" role="tab"
                                   data-toggle="tab">验证人详情</a></li>
        <li role="presentation"><a href="#delegatorCandidateList" aria-controls="delegatorCandidateList" role="tab"
                                   data-toggle="tab">我委托的验证人列表</a></li>
        <li role="presentation"><a href="#getTotalShares" aria-controls="getTotalShares" role="tab"
                                   data-toggle="tab">我的委托总额</a></li>
    </ul>

    <div class="tab-content">
        <div id="getCandidateList" role="tabpanel" class="row col-md-8 col-md-offset-2 tab-pane active">
            <div class="title">
                <p class="bg-primary">验证人列表</p>
            </div>

            <div class="req">
                <form class="form">
                    <div class="form-group">
                        <label for="candidateListReqAddr">Address</label>
                        <input type="text" class="form-control" id="candidateListReqAddr" placeholder="请输入账户地址">
                    </div>
                    <div class="form-group">
                        <label for="candidateListReqPage">Page</label>
                        <input type="number" class="form-control" id="candidateListReqPage" value="1">
                    </div>
                    <div class="form-group">
                        <label for="candidateListReqPerPage">PerPage</label>
                        <input type="number" class="form-control" id="candidateListReqPerPage" value="10">
                    </div>
                    <div class="form-group">
                        <label for="candidateListReqSort">Sort</label>
                        <input type="text" class="form-control" id="candidateListReqSort" value="-voting_power">
                    </div>
                    <div class="form-group">
                        <label for="candidateListReqQ">Query</label>
                        <input type="text" class="form-control" id="candidateListReqQ">
                    </div>
                    <button type="button" class="btn btn-primary">Submit</button>
                </form>
            </div>

            <div class="res">
                <p>Result</p>
                <pre></pre>
            </div>
        </div>

        <div id="getCandidateDetail" role="tabpanel" class="row col-md-8 col-md-offset-2 tab-pane">
            <div class="title">
                <p class="bg-primary">验证人详情</p>
            </div>

            <div class="req">
                <form class="form">
                    <div class="form-group">
                        <label for="candidateDetailReqAddr">Address</label>
                        <input type="text" class="form-control" id="candidateDetailReqAddr">
                    </div>
                    <div class="form-group">
                        <label for="candidateDetailReqPubKey">PubKey</label>
                        <input type="text" class="form-control" id="candidateDetailReqPubKey">
                    </div>
                    <button type="button" class="btn btn-primary">Submit</button>
                </form>
            </div>

            <div class="res">
                <p>Result</p>
                <pre></pre>
            </div>
        </div>

        <div id="delegatorCandidateList" role="tabpanel" class="row col-md-8 col-md-offset-2 tab-pane">
            <div class="title">
                <p class="bg-primary">我委托的验证人列表</p>
            </div>

            <div class="req">
                <form class="form">
                    <div class="form-group">
                        <label for="delegatorCandidateListReqAddr">Address</label>
                        <input type="text" class="form-control" id="delegatorCandidateListReqAddr"
                               placeholder="请输入账户地址">
                    </div>
                    <div class="form-group">
                        <label for="delegatorCandidateListReqPage">Page</label>
                        <input type="number" class="form-control" id="delegatorCandidateListReqPage" value="1">
                    </div>
                    <div class="form-group">
                        <label for="delegatorCandidateListReqPerPage">PerPage</label>
                        <input type="number" class="form-control" id="delegatorCandidateListReqPerPage" value="10">
                    </div>
                    <div class="form-group">
                        <label for="delegatorCandidateListReqSort">Sort</label>
                        <input type="text" class="form-control" id="delegatorCandidateListReqSort"
                               value="-voting_power">
                    </div>
                    <div class="form-group">
                        <label for="delegatorCandidateListReqQ">Query</label>
                        <input type="text" class="form-control" id="delegatorCandidateListReqQ">
                    </div>
                    <button type="button" class="btn btn-primary">Submit</button>
                </form>
            </div>

            <div class="res">
                <p>Result</p>
                <pre></pre>
            </div>
        </div>

        <div id="getTotalShares" role="tabpanel" class="row col-md-8 col-md-offset-2 tab-pane">
            <div class="title">
                <p class="bg-primary">我的委托总额</p>
            </div>

            <div class="req">
                <form class="form">
                    <div class="form-group">
                        <label for="totalSharesReqAddr">Address</label>
                        <input type="text" class="form-control" id="totalSharesReqAddr">
                    </div>
                    <button type="button" class="btn btn-primary">Submit</button>
                </form>
            </div>

            <div class="res">
                <p>Result</p>
                <pre></pre>
            </div>
        </div>
    </div>


</div>

<script src="https://cdn.bootcss.com/jquery/1.12.4/jquery.min.js"></script>

<script src="../codegen/gen-js/thrift.js"></script>

<!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
<script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"
        integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
        crossorigin="anonymous"></script>

<script src="../codegen/gen-js/model_common_types.js"></script>

<script src="../codegen/gen-js/model_candidateList_types.js"></script>
<script src="../codegen/gen-js/model_candidateDetail_types.js"></script>
<script src="../codegen/gen-js/model_delegatorCandidateList_types.js"></script>

<script src="../codegen/gen-js/model_totalShare_types.js"></script>

<script src="../codegen/gen-js/IRISHubService.js"></script>

<script>
    transport = new Thrift.TXHRTransport("http://192.168.150.162:9080/irishub");
    protocol = new Thrift.Protocol(transport);
    client = new IRISHubServiceClient(protocol);

    // getCandidateList
    $("#getCandidateList button").click(function () {
        var res;
        var domRes = $(this).parents("div#getCandidateList").find("div.res > pre");

        var req = new CandidateListRequest();
        req.address = $("#candidateListReqAddr").val();
        req.page = $("#candidateListReqPage").val();
        req.perPage = $("#candidateListReqPerPage").val();
        req.sort = $("#candidateListReqSort").val();
        req.q = $("#candidateListReqQ").val();

        try {
            res = client.GetCandidateList(req)
        } catch (e) {
            res = e.message
        }
        domRes.text(JSON.stringify(res, null, 2));
    });

    // getCandidateDetail
    $("#getCandidateDetail button").click(function () {
        var res;
        var domRes = $(this).parents("div#getCandidateDetail").find("div.res > pre");

        var req = new CandidateDetailRequest();
        req.address = $("#candidateDetailReqAddr").val();
        req.pubKey = $("#candidateDetailReqPubKey").val();

        try {
            res = client.GetCandidateDetail(req)
        } catch (e) {
            res = e.message
        }
        domRes.text(JSON.stringify(res, null, 2));
    });

    // delegatorCandidateList
    $("#delegatorCandidateList button").click(function () {
        var res;
        var domRes = $(this).parents("div#delegatorCandidateList").find("div.res > pre");

        var req = new CandidateListRequest();
        req.address = $("#delegatorCandidateListReqAddr").val();
        req.page = $("#delegatorCandidateListReqPage").val();
        req.perPage = $("#delegatorCandidateListReqPerPage").val();
        req.sort = $("#delegatorCandidateListReqSort").val();
        req.q = $("#delegatorCandidateListReqQ").val();

        try {
            res = client.GetDelegatorCandidateList(req);
        } catch (e) {
            res = e.message
        }
        domRes.text(JSON.stringify(res, null, 2));
    });

    // getTotalShares
    $("#getTotalShares button").click(function () {
        var res;
        var domRes = $(this).parents("div#getTotalShares").find("div.res > pre");

        var address = $("#totalSharesReqAddr").val();
        var req = new TotalShareRequest();
        req.address = address;

        try {
            res = client.GetDelegatorTotalShares(req);
        } catch (e) {
            res = e.message
        }
        domRes.text(JSON.stringify(res, null, 2));
    });
</script>
</body>
</html>